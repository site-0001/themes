{{ $title := (.Title | default "") }}
{{ $href := (.Destination | safeURL) }}
{{ $text := (.Text | safeHTML) }}

{{ $target := "_self" }}{{ $rel := "" }}
{{ if (strings.HasPrefix .Destination "http") }}
{{ $target = "_blank" }}{{ $rel = "noopener nofollow" }}
{{ end }}

{{ $viewer := "" }}
{{ if (or (strings.HasSuffix .Destination ".ppt") (strings.HasSuffix .Destination ".pptx") (strings.HasSuffix .Destination ".doc") (strings.HasSuffix .Destination ".docx") (strings.HasSuffix .Destination ".xls") (strings.HasSuffix .Destination ".xlsx")) }}
{{ $viewer = "https://view.officeapps.live.com/op/view.aspx?src=" }}
{{ end }}

<a title="{{ $title }}" href="{{ $viewer }}{{ $href }}" target="{{ $target }}" rel="{{ $rel }}">{{ $text }}</a>